{"version":3,"file":"observe-slot-presence.js","sources":["../../shared/observe-slot-presence.ts"],"sourcesContent":["/**\n * Copyright 2026 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\nimport { ReactiveElement } from 'lit';\nimport { MutationController } from '@lit-labs/observers/mutation-controller.js';\n\nconst slotContentIsPresent = Symbol('slotContentIsPresent');\n\ntype Constructor<T = Record<string, unknown>> = {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    new (...args: any[]): T;\n    prototype: T;\n};\n\nexport interface SlotPresenceObservingInterface {\n    slotContentIsPresent: boolean;\n    getSlotContentPresence(selector: string): boolean;\n    managePresenceObservedSlot(): void;\n}\n\nexport function ObserveSlotPresence<T extends Constructor<ReactiveElement>>(\n    constructor: T,\n    lightDomSelector: string | string[]\n): T & Constructor<SlotPresenceObservingInterface> {\n    const lightDomSelectors = Array.isArray(lightDomSelector)\n        ? lightDomSelector\n        : [lightDomSelector];\n    class SlotPresenceObservingElement\n        extends constructor\n        implements SlotPresenceObservingInterface\n    {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        constructor(...args: any[]) {\n            super(...args);\n\n            new MutationController(this, {\n                config: {\n                    childList: true,\n                    subtree: true,\n                },\n                callback: () => {\n                    this.managePresenceObservedSlot();\n                },\n            });\n\n            this.managePresenceObservedSlot();\n        }\n\n        /**\n         *  @internal\n         */\n        public get slotContentIsPresent(): boolean {\n            if (lightDomSelectors.length === 1) {\n                return (\n                    this[slotContentIsPresent].get(lightDomSelectors[0]) ||\n                    false\n                );\n            } else {\n                throw new Error(\n                    'Multiple selectors provided to `ObserveSlotPresence` use `getSlotContentPresence(selector: string)` instead.'\n                );\n            }\n        }\n        private [slotContentIsPresent]: Map<string, boolean> = new Map();\n\n        /**\n         * @internal\n         */\n        public getSlotContentPresence(selector: string): boolean {\n            if (this[slotContentIsPresent].has(selector)) {\n                return this[slotContentIsPresent].get(selector) || false;\n            }\n            throw new Error(\n                `The provided selector \\`${selector}\\` is not being observed.`\n            );\n        }\n\n        /**\n         * @internal\n         */\n        public managePresenceObservedSlot = (): void => {\n            let changes = false;\n            lightDomSelectors.forEach((selector) => {\n                const nextValue = !!this.querySelector(`:scope > ${selector}`);\n                const previousValue =\n                    this[slotContentIsPresent].get(selector) || false;\n                changes = changes || previousValue !== nextValue;\n                this[slotContentIsPresent].set(\n                    selector,\n                    !!this.querySelector(`:scope > ${selector}`)\n                );\n            });\n            if (changes) {\n                this.updateComplete.then(() => {\n                    this.requestUpdate();\n                });\n            }\n        };\n    }\n    return SlotPresenceObservingElement;\n}\n"],"names":["slotContentIsPresent","ObserveSlotPresence","constructor","lightDomSelector","_a","_b","lightDomSelectors","SlotPresenceObservingElement","args","changes","selector","nextValue","previousValue","MutationController"],"mappings":";AAcA,MAAMA,IAAuB,OAAO,sBAAsB;AAcnD,SAASC,EACZC,GACAC,GAC+C;AA/BnD,MAAAC,GAAAC;AAgCI,QAAMC,IAAoB,MAAM,QAAQH,CAAgB,IAClDA,IACA,CAACA,CAAgB;AAAA,EACvB,MAAMI,WACMF,IAAAH,GAmCCE,IAAAJ,GAnCDK,GAEZ;AAAA;AAAA,IAEI,eAAeG,GAAa;AACxB,YAAM,GAAGA,CAAI,GA8BjB,KAASJ,CAAA,wBAAkD,IAAA,GAiB3D,KAAO,6BAA6B,MAAY;AAC5C,YAAIK,IAAU;AACd,QAAAH,EAAkB,QAAQ,CAACI,MAAa;AACpC,gBAAMC,IAAY,CAAC,CAAC,KAAK,cAAc,YAAYD,CAAQ,EAAE,GACvDE,IACF,KAAKZ,CAAoB,EAAE,IAAIU,CAAQ,KAAK;AAChD,UAAAD,IAAUA,KAAWG,MAAkBD,GACvC,KAAKX,CAAoB,EAAE;AAAA,YACvBU;AAAA,YACA,CAAC,CAAC,KAAK,cAAc,YAAYA,CAAQ,EAAE;AAAA,UAAA;AAAA,QAEnD,CAAC,GACGD,KACA,KAAK,eAAe,KAAK,MAAM;AAC3B,eAAK,cAAA;AAAA,QACT,CAAC;AAAA,MAET,GA9DI,IAAII,EAAmB,MAAM;AAAA,QACzB,QAAQ;AAAA,UACJ,WAAW;AAAA,UACX,SAAS;AAAA,QAAA;AAAA,QAEb,UAAU,MAAM;AACZ,eAAK,2BAAA;AAAA,QACT;AAAA,MAAA,CACH,GAED,KAAK,2BAAA;AAAA,IACT;AAAA;AAAA;AAAA;AAAA,IAKA,IAAW,uBAAgC;AACvC,UAAIP,EAAkB,WAAW;AAC7B,eACI,KAAKN,CAAoB,EAAE,IAAIM,EAAkB,CAAC,CAAC,KACnD;AAGJ,YAAM,IAAI;AAAA,QACN;AAAA,MAAA;AAAA,IAGZ;AAAA;AAAA;AAAA;AAAA,IAMO,uBAAuBI,GAA2B;AACrD,UAAI,KAAKV,CAAoB,EAAE,IAAIU,CAAQ;AACvC,eAAO,KAAKV,CAAoB,EAAE,IAAIU,CAAQ,KAAK;AAEvD,YAAM,IAAI;AAAA,QACN,2BAA2BA,CAAQ;AAAA,MAAA;AAAA,IAE3C;AAAA,EAAA;AAwBJ,SAAOH;AACX;"}