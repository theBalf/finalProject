{"version":3,"file":"ProgressCircle.base.js","sources":["../../../components/progress-circle/ProgressCircle.base.ts"],"sourcesContent":["/**\n * Copyright 2026 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\nimport { PropertyValues } from 'lit';\nimport { property, query } from 'lit/decorators.js';\n\nimport {\n    SizedMixin,\n    SpectrumElement,\n} from '@spectrum-web-components/core/shared/base/index.js';\nimport { getLabelFromSlot } from '@spectrum-web-components/core/shared/get-label-from-slot.js';\n\nimport {\n    PROGRESS_CIRCLE_VALID_SIZES,\n    ProgressCircleStaticColor,\n} from './ProgressCircle.types.js';\n\n/**\n * A progress circle component that visually represents the completion progress of a task.\n * Can be used in both determinate (with specific progress value) and indeterminate (loading) states.\n *\n * @attribute {ElementSize} size - The size of the progress circle.\n *\n * @todo Why do we support both the slot and the label attribute? Should we deprecate the slot?\n *\n * @todo Figure out why our tool chain doesn't respect the line breaks in this slot description.\n *\n * @slot - Accessible label for the progress circle.\n *\n *   Used to provide context about what is loading or progressing.\n */\nexport abstract class ProgressCircleBase extends SizedMixin(SpectrumElement, {\n    validSizes: PROGRESS_CIRCLE_VALID_SIZES,\n}) {\n    // ─────────────────────────\n    //     API TO OVERRIDE\n    // ─────────────────────────\n\n    /**\n     * @internal\n     *\n     * A readonly array of the valid static colors for the progress circle.\n     *\n     * This is an actual internal property, intended not for customer use\n     * but for use in internal validation logic, stories, tests, etc.\n     *\n     * Because S1 and S2 support different static colors, the value of this\n     * property must be set in each subclass.\n     */\n    static readonly STATIC_COLORS: readonly string[];\n\n    /**\n     * @internal\n     *\n     * Static color variant for use on different backgrounds.\n     *\n     * This is a public property, but its valid values vary between S1 and S2,\n     * so the property (and its docs) need to be redefined in each subclass.\n     *\n     * The type declared here is a union of the valid values for S1 and S2,\n     * and should be narrowed in each subclass.\n     */\n    @property({ type: String, reflect: true, attribute: 'static-color' })\n    public staticColor?: ProgressCircleStaticColor;\n\n    // ──────────────────\n    //     SHARED API\n    // ──────────────────\n\n    /**\n     * Whether the progress circle shows indeterminate progress (loading state).\n     *\n     * When true, displays an animated loading indicator instead of a specific progress value.\n     */\n    @property({ type: Boolean, reflect: true })\n    public indeterminate = false;\n\n    /**\n     * Accessible label for the progress circle.\n     *\n     * Used to provide context about what is loading or progressing.\n     */\n    @property({ type: String })\n    public label = '';\n\n    /**\n     * Progress value from 0 to 100.\n     *\n     * Only relevant when indeterminate is false.\n     */\n    @property({ type: Number })\n    public progress = 0;\n\n    // ──────────────────────\n    //     IMPLEMENTATION\n    // ──────────────────────\n\n    /**\n     * @internal\n     */\n    @query('slot')\n    private slotEl!: HTMLSlotElement;\n\n    protected makeRotation(rotation: number): string | undefined {\n        return this.indeterminate\n            ? undefined\n            : `transform: rotate(${rotation}deg);`;\n    }\n\n    protected handleSlotchange(): void {\n        const labelFromSlot = getLabelFromSlot(this.label, this.slotEl);\n        if (labelFromSlot) {\n            this.label = labelFromSlot;\n        }\n    }\n\n    protected override firstUpdated(changes: PropertyValues): void {\n        super.firstUpdated(changes);\n        if (!this.hasAttribute('role')) {\n            this.setAttribute('role', 'progressbar');\n        }\n    }\n\n    protected override updated(changes: PropertyValues): void {\n        super.updated(changes);\n        if (!this.indeterminate && changes.has('progress')) {\n            this.setAttribute('aria-valuenow', '' + this.progress);\n        } else if (this.hasAttribute('aria-valuenow')) {\n            this.removeAttribute('aria-valuenow');\n        }\n        if (changes.has('label')) {\n            if (this.label.length) {\n                this.setAttribute('aria-label', this.label);\n            } else if (\n                changes.get('label') === this.getAttribute('aria-label')\n            ) {\n                this.removeAttribute('aria-label');\n            }\n        }\n\n        const hasAccessibleName = (): boolean => {\n            return Boolean(\n                this.label ||\n                    this.getAttribute('aria-label') ||\n                    this.getAttribute('aria-labelledby') ||\n                    this.slotEl.assignedNodes().length\n            );\n        };\n\n        if (window.__swc?.DEBUG) {\n            if (\n                !hasAccessibleName() &&\n                this.getAttribute('role') === 'progressbar'\n            ) {\n                window.__swc?.warn(\n                    this,\n                    '<sp-progress-circle> elements need one of the following to be accessible:',\n                    'https://opensource.adobe.com/spectrum-web-components/components/progress-circle/#accessibility',\n                    {\n                        type: 'accessibility',\n                        issues: [\n                            'value supplied to the \"label\" attribute, which will be displayed visually as part of the element, or',\n                            'text content supplied directly to the <sp-progress-circle> element, or',\n                            'value supplied to the \"aria-label\" attribute, which will only be provided to screen readers, or',\n                            'an element ID reference supplied to the \"aria-labelledby\" attribute, which will be provided by screen readers and will need to be managed manually by the parent application.',\n                        ],\n                    }\n                );\n            }\n        }\n    }\n}\n"],"names":["ProgressCircleBase","SizedMixin","SpectrumElement","PROGRESS_CIRCLE_VALID_SIZES","rotation","labelFromSlot","getLabelFromSlot","changes","_a","_b","hasAccessibleName","__decorateClass","property","query"],"mappings":";;;;;;;;;AAuCO,MAAeA,UAA2BC,EAAWC,GAAiB;AAAA,EACzE,YAAYC;AAChB,CAAC,EAAE;AAAA,EAFI,cAAA;AAAA,UAAA,GAAA,SAAA,GA4CH,KAAO,gBAAgB,IAQvB,KAAO,QAAQ,IAQf,KAAO,WAAW;AAAA,EAAA;AAAA,EAYR,aAAaC,GAAsC;AACzD,WAAO,KAAK,gBACN,SACA,qBAAqBA,CAAQ;AAAA,EACvC;AAAA,EAEU,mBAAyB;AAC/B,UAAMC,IAAgBC,EAAiB,KAAK,OAAO,KAAK,MAAM;AAC9D,IAAID,MACA,KAAK,QAAQA;AAAA,EAErB;AAAA,EAEmB,aAAaE,GAA+B;AAC3D,UAAM,aAAaA,CAAO,GACrB,KAAK,aAAa,MAAM,KACzB,KAAK,aAAa,QAAQ,aAAa;AAAA,EAE/C;AAAA,EAEmB,QAAQA,GAA+B;AAnI9D,QAAAC,GAAAC;AAoIQ,UAAM,QAAQF,CAAO,GACjB,CAAC,KAAK,iBAAiBA,EAAQ,IAAI,UAAU,IAC7C,KAAK,aAAa,iBAAiB,KAAK,KAAK,QAAQ,IAC9C,KAAK,aAAa,eAAe,KACxC,KAAK,gBAAgB,eAAe,GAEpCA,EAAQ,IAAI,OAAO,MACf,KAAK,MAAM,SACX,KAAK,aAAa,cAAc,KAAK,KAAK,IAE1CA,EAAQ,IAAI,OAAO,MAAM,KAAK,aAAa,YAAY,KAEvD,KAAK,gBAAgB,YAAY;AAIzC,UAAMG,IAAoB,MACf,GACH,KAAK,SACD,KAAK,aAAa,YAAY,KAC9B,KAAK,aAAa,iBAAiB,KACnC,KAAK,OAAO,gBAAgB;AAIxC,KAAIF,IAAA,OAAO,UAAP,QAAAA,EAAc,SAEV,CAACE,EAAA,KACD,KAAK,aAAa,MAAM,MAAM,mBAE9BD,IAAA,OAAO,UAAP,QAAAA,EAAc;AAAA,MACV;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,QACI,MAAM;AAAA,QACN,QAAQ;AAAA,UACJ;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,QAAA;AAAA,MACJ;AAAA,IACJ;AAAA,EAIhB;AACJ;AA5GWE,EAAA;AAAA,EADNC,EAAS,EAAE,MAAM,QAAQ,SAAS,IAAM,WAAW,gBAAgB;AAAA,GA/BlDZ,EAgCX,WAAA,aAAA;AAYAW,EAAA;AAAA,EADNC,EAAS,EAAE,MAAM,SAAS,SAAS,IAAM;AAAA,GA3CxBZ,EA4CX,WAAA,eAAA;AAQAW,EAAA;AAAA,EADNC,EAAS,EAAE,MAAM,OAAA,CAAQ;AAAA,GAnDRZ,EAoDX,WAAA,OAAA;AAQAW,EAAA;AAAA,EADNC,EAAS,EAAE,MAAM,OAAA,CAAQ;AAAA,GA3DRZ,EA4DX,WAAA,UAAA;AAUCW,EAAA;AAAA,EADPE,EAAM,MAAM;AAAA,GArEKb,EAsEV,WAAA,QAAA;"}